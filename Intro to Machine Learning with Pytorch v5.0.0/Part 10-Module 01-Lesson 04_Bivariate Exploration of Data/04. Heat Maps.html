<!-- udacity2.0 -->
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Heat Maps</title>
  <link rel="stylesheet" href="../assets/css/bootstrap.min.css">
  <link rel="stylesheet" href="../assets/css/plyr.css">
  <link rel="stylesheet" href="../assets/css/katex.min.css">
  <link rel="stylesheet" href="../assets/css/jquery.mCustomScrollbar.min.css">
  <link rel="stylesheet" href="../assets/css/styles.css">
  <link rel="shortcut icon" type="image/png" href="../assets/img/udacimak.png" />
</head>

<body>
  <div class="wrapper">
    <nav id="sidebar">
  <div class="sidebar-header">
    <h3>Bivariate Exploration of Data</h3>
  </div>

  <ul class="sidebar-list list-unstyled CTAs">
    <li>
      <a href="../index.html" class="article">Back to Home</a>
    </li>
  </ul>

  <ul class="sidebar-list list-unstyled components">
    <li class="">
      <a href="01. Introduction.html">01. Introduction</a>
    </li>
    <li class="">
      <a href="02. Scatterplots and Correlation.html">02. Scatterplots and Correlation</a>
    </li>
    <li class="">
      <a href="03. Overplotting, Transparency, and Jitter.html">03. Overplotting, Transparency, and Jitter</a>
    </li>
    <li class="">
      <a href="04. Heat Maps.html">04. Heat Maps</a>
    </li>
    <li class="">
      <a href="05. Scatterplot Practice.html">05. Scatterplot Practice</a>
    </li>
    <li class="">
      <a href="06. Violin Plots.html">06. Violin Plots</a>
    </li>
    <li class="">
      <a href="07. Box Plots.html">07. Box Plots</a>
    </li>
    <li class="">
      <a href="08. Violin and Box Plot Practice.html">08. Violin and Box Plot Practice</a>
    </li>
    <li class="">
      <a href="09. Clustered Bar Charts.html">09. Clustered Bar Charts</a>
    </li>
    <li class="">
      <a href="10. Categorical Plot Practice.html">10. Categorical Plot Practice</a>
    </li>
    <li class="">
      <a href="11. Faceting.html">11. Faceting</a>
    </li>
    <li class="">
      <a href="12. Adaptation of Univariate Plots.html">12. Adaptation of Univariate Plots</a>
    </li>
    <li class="">
      <a href="13. Line Plots.html">13. Line Plots</a>
    </li>
    <li class="">
      <a href="14. Additional Plot Practice.html">14. Additional Plot Practice</a>
    </li>
    <li class="">
      <a href="15. Lesson Summary.html">15. Lesson Summary</a>
    </li>
    <li class="">
      <a href="16. Extra Q-Q Plots.html">16. Extra: Q-Q Plots</a>
    </li>
    <li class="">
      <a href="17. Extra Swarm Plots.html">17. Extra: Swarm Plots</a>
    </li>
    <li class="">
      <a href="18. Extra Rug and Strip Plots.html">18. Extra: Rug and Strip Plots</a>
    </li>
    <li class="">
      <a href="19. Extra Stacked Plots.html">19. Extra: Stacked Plots</a>
    </li>
    <li class="">
      <a href="20. Extra Ridgeline Plots.html">20. Extra: Ridgeline Plots</a>
    </li>
  </ul>

  <ul class="sidebar-list list-unstyled CTAs">
    <li>
      <a href="../index.html" class="article">Back to Home</a>
    </li>
  </ul>
</nav>

    <div id="content">
      <header class="container-fluild header">
        <div class="container">
          <div class="row">
            <div class="col-12">
              <div class="align-items-middle">
                <button type="button" id="sidebarCollapse" class="btn btn-toggle-sidebar">
                  <div></div>
                  <div></div>
                  <div></div>
                </button>

                <h1 style="display: inline-block">04. Heat Maps</h1>
              </div>
            </div>
          </div>
        </div>
      </header>

      <main class="container">
        <div class="row">
          <div class="col-12">
            <div class="ud-atom">
  <h3><p>L4 041 Heat Maps V4</p></h3>
  <video controls>
  <source src="04. L4 041 Heat Maps V4-RyCdvsmBjtE.mp4" type="video/mp4">

  <track default="false" kind="subtitles" srclang="zh-CN" src="04. L4 041 Heat Maps V4-RyCdvsmBjtE.zh-CN.vtt" label="zh-CN">
  <track default="true" kind="subtitles" srclang="en" src="04. L4 041 Heat Maps V4-RyCdvsmBjtE.en.vtt" label="en">
  <track default="false" kind="subtitles" srclang="pt-BR" src="04. L4 041 Heat Maps V4-RyCdvsmBjtE.pt-BR.vtt" label="pt-BR">
</video>


</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <hr>
</div>

</div>
<div class="divider"></div><div class="ud-atom">
  <h3><p>Data Vis L4 C04 V1</p></h3>
  <video controls>
  <source src="04. Data Vis L4 C04 V1-O6ElT4IFXc0.mp4" type="video/mp4">

  <track default="false" kind="subtitles" srclang="zh-CN" src="04. Data Vis L4 C04 V1-O6ElT4IFXc0.zh-CN.vtt" label="zh-CN">
  <track default="true" kind="subtitles" srclang="en" src="04. Data Vis L4 C04 V1-O6ElT4IFXc0.en.vtt" label="en">
  <track default="false" kind="subtitles" srclang="pt-BR" src="04. Data Vis L4 C04 V1-O6ElT4IFXc0.pt-BR.vtt" label="pt-BR">
</video>


</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <hr>
<h2 id="heat-maps">Heat Maps</h2>
<p>A <strong>heat map</strong> is a 2-d version of the histogram that can be used as an alternative to a scatterplot. Like a scatterplot, the values of the two numeric variables to be plotted are placed on the plot axes. Similar to a histogram, the plotting area is divided into a grid and the number of points in each grid rectangle is added up. Since there won't be room for bar heights, counts are indicated instead by grid cell color. A heat map can be implemented with Matplotlib's <a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.hist2d.html" rel="noopener noreferrer" target="_blank">hist2d()</a> function. </p>
</div>

</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <p><strong>Heat maps are useful in the following cases:</strong></p>
<ol>
<li>To represent a plot for discrete vs. another discrete variable</li>
<li>As an alternative to transparency when the data points are enormous </li>
</ol>
<h3 id="example-1-default-heat-plot-using-matplotlibpyplothist2d-function">Example 1. Default heat plot using Matplotlib.pyplot.hist2d() function</h3>
<pre><code class="python language-python"># TO DO: Necessary import

# Read the CSV file
fuel_econ = pd.read_csv('fuel_econ.csv')
fuel_econ.head(10)


plt.figure(figsize = [18, 6])

# PLOT ON LEFT
plt.subplot(1, 2, 1)
sb.regplot(data = fuel_econ, x = 'displ', y = 'comb', x_jitter=0.04, scatter_kws={'alpha':1/10}, fit_reg=False)
plt.xlabel('Displacement (1)')
plt.ylabel('Combined Fuel Eff. (mpg)');

# PLOT ON RIGHT
plt.subplot(1, 2, 2)
plt.hist2d(data = fuel_econ, x = 'displ', y = 'comb')
plt.colorbar()
plt.xlabel('Displacement (1)')
plt.ylabel('Combined Fuel Eff. (mpg)');</code></pre>
</div>

</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <figure class="figure">
    <img src="img/download-46.png" alt="A scatter plot vs heat plot based on the same data" class="img img-fluid">
    <figcaption class="figure-caption">
      <p>A scatter plot vs heat plot based on the same data</p>
    </figcaption>
  </figure>
</div>


</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <p>In the example above, we added a <a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.colorbar.html" rel="noopener noreferrer" target="_blank">colorbar()</a> function call to add a colorbar to the side of the plot, showing the mapping from counts to colors.</p>
</div>

</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <h2 id="additional-variations">Additional Variations</h2>
<p>To select a different color palette, you can set the "cmap" parameter in <code>hist2d</code>. The most convenient way of doing this is to set the "cmap" value as a string referencing a built-in Matplotlib palette. A list of valid strings can be found on <a href="https://matplotlib.org/api/pyplot_summary.html#colors-in-matplotlib" rel="noopener noreferrer" target="_blank">this part</a> of the Pyplot API documentation. A further discussion of color in plots will be left to the next lesson. For now, I will just show an example of reversing the default "viridis" color palette, by setting <code>cmap = 'viridis_r'</code>.</p>
<p>Furthermore, I would like to distinguish cells with zero counts from those with non-zero counts. The "cmin" parameter specifies the minimum value in a cell before it will be plotted. By adding a <code>cmin = 0.5</code> parameter to the <code>hist2d</code> call, this means that a cell will only get colored if it contains at least one point.</p>
</div>

</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <h3 id="example-2-heat-plot---set-a-minimum-bound-on-counts-and-a-reverse-color-map">Example 2. Heat plot - Set a minimum bound on counts and a reverse color map</h3>
<pre><code class="python language-python"># Use cmin to set a minimum bound of counts 
# Use cmap to reverse the color map. 
plt.hist2d(data = fuel_econ, x = 'displ', y = 'comb', cmin=0.5, cmap='viridis_r')
plt.colorbar()
plt.xlabel('Displacement (1)')
plt.ylabel('Combined Fuel Eff. (mpg)');</code></pre>
</div>

</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <figure class="figure">
    <img src="img/download-47.png" alt="" class="img img-fluid">
    <figcaption class="figure-caption">
      
    </figcaption>
  </figure>
</div>


</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <p>As the count of points in the cell increases, the color in the heatmap gets brighter and moves from blue to yellow.</p>
</div>

</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <h3 id="example-3-heat-plot---specify-bin-edges">Example 3. Heat plot - Specify bin edges</h3>
<pre><code class="python language-python"># Specify bin edges 
bins_x = np.arange(0.6, 7+0.3, 0.3)
bins_y = np.arange(12, 58+3, 3)

plt.hist2d(data = fuel_econ, x = 'displ', y = 'comb', cmin=0.5, cmap='viridis_r', bins = [bins_x, bins_y])
plt.colorbar()
plt.xlabel('Displacement (1)')
plt.ylabel('Combined Fuel Eff. (mpg)');

# Notice the areas of high frequency in the middle of the negative trend in the plot.</code></pre>
</div>

</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <figure class="figure">
    <img src="img/download-48.png" alt="A heat plot with a custom bin size" class="img img-fluid">
    <figcaption class="figure-caption">
      <p>A heat plot with a custom bin size</p>
    </figcaption>
  </figure>
</div>


</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <p>Notice that since we have two variables, the "bins" parameter takes a list of two bin edge specifications, one for each dimension. Choosing an appropriate bin size is just as important here as it was for the univariate histogram. </p>
</div>

</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <h2 id="annotations-on-each-cell">Annotations on each cell</h2>
<p>If you have a lot of data, you might want to add annotations to cells in the plot indicating the count of points in each cell. From <code>hist2d</code>, this requires the addition of text elements one by one, much like how text annotations were added one by one to the bar plots in the previous lesson. We can get the counts to annotate directly from what is returned by <code>hist2d</code>, which includes not just the plotting object, but an array of counts and two vectors of bin edges.</p>
</div>

</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <h3 id="example-4-add-text-annotation-on-each-cell-using-pyplottext-function">Example 4. Add text annotation on each cell using pyplot.text() function</h3>
<pre><code class="python language-python"># Specify bin edges 
bins_x = np.arange(0.6, 7+0.7, 0.7)
bins_y = np.arange(12, 58+7, 7)
# Use cmin to set a minimum bound of counts 
# Use cmap to reverse the color map. 
h2d = plt.hist2d(data = fuel_econ, x = 'displ', y = 'comb', cmin=0.5, cmap='viridis_r', bins = [bins_x, bins_y])

plt.colorbar()
plt.xlabel('Displacement (1)')
plt.ylabel('Combined Fuel Eff. (mpg)');

# Select the bi-dimensional histogram, a 2D array of samples x and y. 
# Values in x are histogrammed along the first dimension and 
# values in y are histogrammed along the second dimension.
counts = h2d[0]

# Add text annotation on each cell
# Loop through the cell counts and add text annotations for each
for i in range(counts.shape[0]):
    for j in range(counts.shape[1]):
        c = counts[i,j]
        if c &gt;= 100: # increase visibility on darker cells
            plt.text(bins_x[i]+0.5, bins_y[j]+0.5, int(c),
                     ha = 'center', va = 'center', color = 'white')
        elif c &gt; 0:
            plt.text(bins_x[i]+0.5, bins_y[j]+0.5, int(c),
                     ha = 'center', va = 'center', color = 'black')</code></pre>
</div>

</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <figure class="figure">
    <img src="img/download-49.png" alt="A heat plot with annotation on each cell" class="img img-fluid">
    <figcaption class="figure-caption">
      <p>A heat plot with annotation on each cell</p>
    </figcaption>
  </figure>
</div>


</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <p>If you have too many cells in your heat map, then the annotations will end up being too overwhelming, too much to attend to. In cases like that, it's best to leave off the annotations and let the data and colorbar speak for themselves. </p>
<p>You're more likely to see annotations in a categorical heat map, where there are going to be fewer cells plotted. Indeed, there is a parameter built into seaborn's <code>heatmap()</code> function that is built for categorical heatmaps, as will be seen later.</p>
</div>

</div>
<div class="divider"></div>
          </div>

          <div class="col-12">
            <p class="text-right">
              <a href="05. Scatterplot Practice.html" class="btn btn-outline-primary mt-4" role="button">Next Concept</a>
            </p>
          </div>
        </div>
      </main>

      <footer class="footer">
        <div class="container">
          <div class="row">
            <div class="col-12">
              <p class="text-center">
                <a href="https://us-udacity.github.io/" target="_blank">【udacity2.0 】If you need more courses, please add wechat：udacity6</a>
              </p>
            </div>
          </div>
        </div>
      </footer>
    </div>
  </div>


  <script src="../assets/js/jquery-3.3.1.min.js"></script>
  <script src="../assets/js/plyr.polyfilled.min.js"></script>
  <script src="../assets/js/bootstrap.min.js"></script>
  <script src="../assets/js/jquery.mCustomScrollbar.concat.min.js"></script>
  <script src="../assets/js/katex.min.js"></script>
  <script>
    // Initialize Plyr video players
    const players = Array.from(document.querySelectorAll('video')).map(p => new Plyr(p));

    // render math equations
    let elMath = document.getElementsByClassName('mathquill');
    for (let i = 0, len = elMath.length; i < len; i += 1) {
      const el = elMath[i];

      katex.render(el.textContent, el, {
        throwOnError: false
      });
    }

    // this hack will make sure Bootstrap tabs work when using Handlebars
    if ($('#question-tabs').length && $('#user-answer-tabs').length) {
      $("#question-tabs a.nav-link").on('click', function () {
        $("#question-tab-contents .tab-pane").hide();
        $($(this).attr("href")).show();
      });
      $("#user-answer-tabs a.nav-link").on('click', function () {
        $("#user-answer-tab-contents .tab-pane").hide();
        $($(this).attr("href")).show();
      });
    } else {
      $("a.nav-link").on('click', function () {
        $(".tab-pane").hide();
        $($(this).attr("href")).show();
      });
    }

    // side bar events
    $(document).ready(function () {
      $("#sidebar").mCustomScrollbar({
        theme: "minimal"
      });

      $('#sidebarCollapse').on('click', function () {
        $('#sidebar, #content').toggleClass('active');
        $('.collapse.in').toggleClass('in');
        $('a[aria-expanded=true]').attr('aria-expanded', 'false');
      });

      // scroll to first video on page loading
      if ($('video').length) {
        $('html,body').animate({ scrollTop: $('div.plyr').prev().offset().top});
      }

      // auto play first video: this may not work with chrome/safari due to autoplay policy
      if (players && players.length > 0) {
        players[0].play();
      }

      // scroll sidebar to current concept
      const currentInSideBar = $( "ul.sidebar-list.components li a:contains('04. Heat Maps')" )
      currentInSideBar.css( "text-decoration", "underline" );
      $("#sidebar").mCustomScrollbar('scrollTo', currentInSideBar);
    });
  </script>
</body>

</html>
