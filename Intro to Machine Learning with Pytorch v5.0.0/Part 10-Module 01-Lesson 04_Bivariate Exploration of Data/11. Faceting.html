<!-- udacity2.0 -->
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Faceting</title>
  <link rel="stylesheet" href="../assets/css/bootstrap.min.css">
  <link rel="stylesheet" href="../assets/css/plyr.css">
  <link rel="stylesheet" href="../assets/css/katex.min.css">
  <link rel="stylesheet" href="../assets/css/jquery.mCustomScrollbar.min.css">
  <link rel="stylesheet" href="../assets/css/styles.css">
  <link rel="shortcut icon" type="image/png" href="../assets/img/udacimak.png" />
</head>

<body>
  <div class="wrapper">
    <nav id="sidebar">
  <div class="sidebar-header">
    <h3>Bivariate Exploration of Data</h3>
  </div>

  <ul class="sidebar-list list-unstyled CTAs">
    <li>
      <a href="../index.html" class="article">Back to Home</a>
    </li>
  </ul>

  <ul class="sidebar-list list-unstyled components">
    <li class="">
      <a href="01. Introduction.html">01. Introduction</a>
    </li>
    <li class="">
      <a href="02. Scatterplots and Correlation.html">02. Scatterplots and Correlation</a>
    </li>
    <li class="">
      <a href="03. Overplotting, Transparency, and Jitter.html">03. Overplotting, Transparency, and Jitter</a>
    </li>
    <li class="">
      <a href="04. Heat Maps.html">04. Heat Maps</a>
    </li>
    <li class="">
      <a href="05. Scatterplot Practice.html">05. Scatterplot Practice</a>
    </li>
    <li class="">
      <a href="06. Violin Plots.html">06. Violin Plots</a>
    </li>
    <li class="">
      <a href="07. Box Plots.html">07. Box Plots</a>
    </li>
    <li class="">
      <a href="08. Violin and Box Plot Practice.html">08. Violin and Box Plot Practice</a>
    </li>
    <li class="">
      <a href="09. Clustered Bar Charts.html">09. Clustered Bar Charts</a>
    </li>
    <li class="">
      <a href="10. Categorical Plot Practice.html">10. Categorical Plot Practice</a>
    </li>
    <li class="">
      <a href="11. Faceting.html">11. Faceting</a>
    </li>
    <li class="">
      <a href="12. Adaptation of Univariate Plots.html">12. Adaptation of Univariate Plots</a>
    </li>
    <li class="">
      <a href="13. Line Plots.html">13. Line Plots</a>
    </li>
    <li class="">
      <a href="14. Additional Plot Practice.html">14. Additional Plot Practice</a>
    </li>
    <li class="">
      <a href="15. Lesson Summary.html">15. Lesson Summary</a>
    </li>
    <li class="">
      <a href="16. Extra Q-Q Plots.html">16. Extra: Q-Q Plots</a>
    </li>
    <li class="">
      <a href="17. Extra Swarm Plots.html">17. Extra: Swarm Plots</a>
    </li>
    <li class="">
      <a href="18. Extra Rug and Strip Plots.html">18. Extra: Rug and Strip Plots</a>
    </li>
    <li class="">
      <a href="19. Extra Stacked Plots.html">19. Extra: Stacked Plots</a>
    </li>
    <li class="">
      <a href="20. Extra Ridgeline Plots.html">20. Extra: Ridgeline Plots</a>
    </li>
  </ul>

  <ul class="sidebar-list list-unstyled CTAs">
    <li>
      <a href="../index.html" class="article">Back to Home</a>
    </li>
  </ul>
</nav>

    <div id="content">
      <header class="container-fluild header">
        <div class="container">
          <div class="row">
            <div class="col-12">
              <div class="align-items-middle">
                <button type="button" id="sidebarCollapse" class="btn btn-toggle-sidebar">
                  <div></div>
                  <div></div>
                  <div></div>
                </button>

                <h1 style="display: inline-block">11. Faceting</h1>
              </div>
            </div>
          </div>
        </div>
      </header>

      <main class="container">
        <div class="row">
          <div class="col-12">
            <div class="ud-atom">
  <h3><p>L4 111 Faceting V2</p></h3>
  <video controls>
  <source src="11. L4 111 Faceting V2-oUYRqI6wFGw.mp4" type="video/mp4">

  <track default="false" kind="subtitles" srclang="zh-CN" src="11. L4 111 Faceting V2-oUYRqI6wFGw.zh-CN.vtt" label="zh-CN">
  <track default="true" kind="subtitles" srclang="en" src="11. L4 111 Faceting V2-oUYRqI6wFGw.en.vtt" label="en">
  <track default="false" kind="subtitles" srclang="pt-BR" src="11. L4 111 Faceting V2-oUYRqI6wFGw.pt-BR.vtt" label="pt-BR">
</video>


</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <hr>
</div>

</div>
<div class="divider"></div><div class="ud-atom">
  <h3><p>Data Vis L4 C11 V1</p></h3>
  <video controls>
  <source src="11. Data Vis L4 C11 V1-3Ls6w8Cd8n4.mp4" type="video/mp4">

  <track default="false" kind="subtitles" srclang="zh-CN" src="11. Data Vis L4 C11 V1-3Ls6w8Cd8n4.zh-CN.vtt" label="zh-CN">
  <track default="true" kind="subtitles" srclang="en" src="11. Data Vis L4 C11 V1-3Ls6w8Cd8n4.en.vtt" label="en">
  <track default="false" kind="subtitles" srclang="pt-BR" src="11. Data Vis L4 C11 V1-3Ls6w8Cd8n4.pt-BR.vtt" label="pt-BR">
</video>


</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <hr>
<h2 id="faceting">Faceting</h2>
<p>One general visualization technique that will be useful for you to know about to handle plots of two or more variables is <strong>faceting</strong>. In faceting, the data is divided into disjoint subsets, most often by different levels of a categorical variable. For each of these subsets of the data, the same plot type is rendered on other variables. Faceting is a way of comparing distributions or relationships across levels of additional variables, especially when there are three or more variables of interest overall. While faceting is most useful in multivariate visualization, it is still valuable to introduce the technique here in our discussion of bivariate plots.</p>
<p>For example, rather than depicting the relationship between one numeric variable and one categorical variable using a violin plot or box plot, we could use faceting to look at a histogram of the numeric variable for subsets of the data divided by categorical variable levels. Seaborn's <a href="https://seaborn.pydata.org/generated/seaborn.FacetGrid.html" rel="noopener noreferrer" target="_blank">FacetGrid</a> class facilitates the creation of faceted plots. There are two steps involved in creating a faceted plot. First, we need to create an instance of the FacetGrid object and specify the feature we want to facet by (<em>vehicle class, "VClass" in our example</em>). Then we use the <code>map</code> method on the FacetGrid object to specify the plot type and variable(s) that will be plotted in each subset (<em>in this case, the histogram on combined fuel efficiency "comb"</em>).</p>
<h3 id="example-1">Example 1.</h3>
<pre><code class="python language-python"># Preparatory Step
fuel_econ = pd.read_csv('fuel_econ.csv')

# Convert the "VClass" column from a plain object type into an ordered categorical type
sedan_classes = ['Minicompact Cars', 'Subcompact Cars', 'Compact Cars', 'Midsize Cars', 'Large Cars']
vclasses = pd.api.types.CategoricalDtype(ordered=True, categories=sedan_classes)
fuel_econ['VClass'] = fuel_econ['VClass'].astype(vclasses);

# Plot the Seaborn's FacetGrid
g = sb.FacetGrid(data = fuel_econ, col = 'VClass')
g.map(plt.hist, "comb")</code></pre>
<p>In the <code>map</code> call, just set the plotting function and variable to be plotted as positional arguments. Don't set them as keyword arguments, like <code>x = "comb"</code>, or the mapping won't work properly.</p>
</div>

</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <figure class="figure">
    <img src="img/download-60.png" alt="" class="img img-fluid">
    <figcaption class="figure-caption">
      
    </figcaption>
  </figure>
</div>


</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <p>Notice that each subset of the data is being plotted independently. Each uses the default of ten bins from <code>hist</code> to bin together the data, and each plot has a different bin size. Despite that, the axis limits on each facet are the same to allow clear and direct comparisons between groups. It's still worth cleaning things a little bit more by setting the same bin edges on all facets. Extra visualization parameters can be set as additional keyword arguments to the <code>map</code> function.</p>
<h3 id="example-2">Example 2.</h3>
<pre><code class="python language-python">bin_edges = np.arange(12, 58+2, 2)

# Try experimenting with dynamic bin edges
# bin_edges = np.arange(-3, fuel_econ['comb'].max()+1/3, 1/3)

g = sb.FacetGrid(data = fuel_econ, col = 'VClass', col_wrap=3, sharey=False)
g.map(plt.hist, 'comb', bins = bin_edges);</code></pre>
</div>

</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <figure class="figure">
    <img src="img/download-61.png" alt="" class="img img-fluid">
    <figcaption class="figure-caption">
      
    </figcaption>
  </figure>
</div>


</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <h2 id="additional-variation">Additional Variation</h2>
<p>If you have many categorical levels to plot, then you might want to add more arguments to the FacetGrid object's initialization to facilitate clarity in the conveyance of information. The example below includes a categorical variable, "trans", that has 27 different transmission types. Setting <code>col_wrap = 7</code> means that the plots will be organized into rows of 7 facets each, rather than a single long row of 27 plots.</p>
<p>Also, we want to have the facets for each transmission type in the decreasing order of combined fuel efficiency.</p>
<h3 id="example-3">Example 3.</h3>
<pre><code class="python language-python"># Find the order in which you want to display the Facets
# For each transmission type, find the combined fuel efficiency
group_means = fuel_econ[['trans', 'comb']].groupby(['trans']).mean()

# Select only the list of transmission type in the decreasing order of combined fuel efficiency
group_order = group_means.sort_values(['comb'], ascending = False).index

# Use the argument col_order to display the FacetGrid in the desirable group_order
g = sb.FacetGrid(data = fuel_econ, col = 'trans', col_wrap = 7, col_order = group_order)
g.map(plt.hist, 'comb')</code></pre>
</div>

</div>
<div class="divider"></div>
          </div>

          <div class="col-12">
            <p class="text-right">
              <a href="12. Adaptation of Univariate Plots.html" class="btn btn-outline-primary mt-4" role="button">Next Concept</a>
            </p>
          </div>
        </div>
      </main>

      <footer class="footer">
        <div class="container">
          <div class="row">
            <div class="col-12">
              <p class="text-center">
                <a href="https://us-udacity.github.io/" target="_blank">【udacity2.0 】If you need more courses, please add wechat：udacity6</a>
              </p>
            </div>
          </div>
        </div>
      </footer>
    </div>
  </div>


  <script src="../assets/js/jquery-3.3.1.min.js"></script>
  <script src="../assets/js/plyr.polyfilled.min.js"></script>
  <script src="../assets/js/bootstrap.min.js"></script>
  <script src="../assets/js/jquery.mCustomScrollbar.concat.min.js"></script>
  <script src="../assets/js/katex.min.js"></script>
  <script>
    // Initialize Plyr video players
    const players = Array.from(document.querySelectorAll('video')).map(p => new Plyr(p));

    // render math equations
    let elMath = document.getElementsByClassName('mathquill');
    for (let i = 0, len = elMath.length; i < len; i += 1) {
      const el = elMath[i];

      katex.render(el.textContent, el, {
        throwOnError: false
      });
    }

    // this hack will make sure Bootstrap tabs work when using Handlebars
    if ($('#question-tabs').length && $('#user-answer-tabs').length) {
      $("#question-tabs a.nav-link").on('click', function () {
        $("#question-tab-contents .tab-pane").hide();
        $($(this).attr("href")).show();
      });
      $("#user-answer-tabs a.nav-link").on('click', function () {
        $("#user-answer-tab-contents .tab-pane").hide();
        $($(this).attr("href")).show();
      });
    } else {
      $("a.nav-link").on('click', function () {
        $(".tab-pane").hide();
        $($(this).attr("href")).show();
      });
    }

    // side bar events
    $(document).ready(function () {
      $("#sidebar").mCustomScrollbar({
        theme: "minimal"
      });

      $('#sidebarCollapse').on('click', function () {
        $('#sidebar, #content').toggleClass('active');
        $('.collapse.in').toggleClass('in');
        $('a[aria-expanded=true]').attr('aria-expanded', 'false');
      });

      // scroll to first video on page loading
      if ($('video').length) {
        $('html,body').animate({ scrollTop: $('div.plyr').prev().offset().top});
      }

      // auto play first video: this may not work with chrome/safari due to autoplay policy
      if (players && players.length > 0) {
        players[0].play();
      }

      // scroll sidebar to current concept
      const currentInSideBar = $( "ul.sidebar-list.components li a:contains('11. Faceting')" )
      currentInSideBar.css( "text-decoration", "underline" );
      $("#sidebar").mCustomScrollbar('scrollTo', currentInSideBar);
    });
  </script>
</body>

</html>
