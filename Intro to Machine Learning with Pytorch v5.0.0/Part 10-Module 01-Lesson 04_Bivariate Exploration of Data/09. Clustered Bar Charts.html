<!-- udacity2.0 -->
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Clustered Bar Charts</title>
  <link rel="stylesheet" href="../assets/css/bootstrap.min.css">
  <link rel="stylesheet" href="../assets/css/plyr.css">
  <link rel="stylesheet" href="../assets/css/katex.min.css">
  <link rel="stylesheet" href="../assets/css/jquery.mCustomScrollbar.min.css">
  <link rel="stylesheet" href="../assets/css/styles.css">
  <link rel="shortcut icon" type="image/png" href="../assets/img/udacimak.png" />
</head>

<body>
  <div class="wrapper">
    <nav id="sidebar">
  <div class="sidebar-header">
    <h3>Bivariate Exploration of Data</h3>
  </div>

  <ul class="sidebar-list list-unstyled CTAs">
    <li>
      <a href="../index.html" class="article">Back to Home</a>
    </li>
  </ul>

  <ul class="sidebar-list list-unstyled components">
    <li class="">
      <a href="01. Introduction.html">01. Introduction</a>
    </li>
    <li class="">
      <a href="02. Scatterplots and Correlation.html">02. Scatterplots and Correlation</a>
    </li>
    <li class="">
      <a href="03. Overplotting, Transparency, and Jitter.html">03. Overplotting, Transparency, and Jitter</a>
    </li>
    <li class="">
      <a href="04. Heat Maps.html">04. Heat Maps</a>
    </li>
    <li class="">
      <a href="05. Scatterplot Practice.html">05. Scatterplot Practice</a>
    </li>
    <li class="">
      <a href="06. Violin Plots.html">06. Violin Plots</a>
    </li>
    <li class="">
      <a href="07. Box Plots.html">07. Box Plots</a>
    </li>
    <li class="">
      <a href="08. Violin and Box Plot Practice.html">08. Violin and Box Plot Practice</a>
    </li>
    <li class="">
      <a href="09. Clustered Bar Charts.html">09. Clustered Bar Charts</a>
    </li>
    <li class="">
      <a href="10. Categorical Plot Practice.html">10. Categorical Plot Practice</a>
    </li>
    <li class="">
      <a href="11. Faceting.html">11. Faceting</a>
    </li>
    <li class="">
      <a href="12. Adaptation of Univariate Plots.html">12. Adaptation of Univariate Plots</a>
    </li>
    <li class="">
      <a href="13. Line Plots.html">13. Line Plots</a>
    </li>
    <li class="">
      <a href="14. Additional Plot Practice.html">14. Additional Plot Practice</a>
    </li>
    <li class="">
      <a href="15. Lesson Summary.html">15. Lesson Summary</a>
    </li>
    <li class="">
      <a href="16. Extra Q-Q Plots.html">16. Extra: Q-Q Plots</a>
    </li>
    <li class="">
      <a href="17. Extra Swarm Plots.html">17. Extra: Swarm Plots</a>
    </li>
    <li class="">
      <a href="18. Extra Rug and Strip Plots.html">18. Extra: Rug and Strip Plots</a>
    </li>
    <li class="">
      <a href="19. Extra Stacked Plots.html">19. Extra: Stacked Plots</a>
    </li>
    <li class="">
      <a href="20. Extra Ridgeline Plots.html">20. Extra: Ridgeline Plots</a>
    </li>
  </ul>

  <ul class="sidebar-list list-unstyled CTAs">
    <li>
      <a href="../index.html" class="article">Back to Home</a>
    </li>
  </ul>
</nav>

    <div id="content">
      <header class="container-fluild header">
        <div class="container">
          <div class="row">
            <div class="col-12">
              <div class="align-items-middle">
                <button type="button" id="sidebarCollapse" class="btn btn-toggle-sidebar">
                  <div></div>
                  <div></div>
                  <div></div>
                </button>

                <h1 style="display: inline-block">09. Clustered Bar Charts</h1>
              </div>
            </div>
          </div>
        </div>
      </header>

      <main class="container">
        <div class="row">
          <div class="col-12">
            <div class="ud-atom">
  <h3><p>L4 091 Clustered Bar Charts V4</p></h3>
  <video controls>
  <source src="09. L4 091 Clustered Bar Charts V4-0rFp55TtEJM.mp4" type="video/mp4">

  <track default="false" kind="subtitles" srclang="zh-CN" src="09. L4 091 Clustered Bar Charts V4-0rFp55TtEJM.zh-CN.vtt" label="zh-CN">
  <track default="true" kind="subtitles" srclang="en" src="09. L4 091 Clustered Bar Charts V4-0rFp55TtEJM.en.vtt" label="en">
  <track default="false" kind="subtitles" srclang="pt-BR" src="09. L4 091 Clustered Bar Charts V4-0rFp55TtEJM.pt-BR.vtt" label="pt-BR">
</video>


</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <hr>
</div>

</div>
<div class="divider"></div><div class="ud-atom">
  <h3><p>Data Vis L4 C09 V1</p></h3>
  <video controls>
  <source src="09. Data Vis L4 C09 V1-OnzWhpgM9Vs.mp4" type="video/mp4">

  <track default="false" kind="subtitles" srclang="zh-CN" src="09. Data Vis L4 C09 V1-OnzWhpgM9Vs.zh-CN.vtt" label="zh-CN">
  <track default="true" kind="subtitles" srclang="en" src="09. Data Vis L4 C09 V1-OnzWhpgM9Vs.en.vtt" label="en">
  <track default="false" kind="subtitles" srclang="pt-BR" src="09. Data Vis L4 C09 V1-OnzWhpgM9Vs.pt-BR.vtt" label="pt-BR">
</video>


</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <hr>
<h2 id="clustered-bar-charts">Clustered Bar Charts</h2>
<p>To depict the relationship between two categorical variables, we can extend the univariate bar chart seen in the previous lesson into a <strong>clustered bar chart</strong>. Like a standard bar chart, we still want to depict the count of data points in each group, but each group is now a combination of labels on two variables. So we want to organize the bars into an order that makes the plot easy to interpret. In a clustered bar chart, bars are organized into clusters based on levels of the first variable, and then bars are ordered consistently across the second variable within each cluster. This is easiest to see with an example, using seaborn's <a href="https://seaborn.pydata.org/generated/seaborn.countplot.html" rel="noopener noreferrer" target="_blank"><code>countplot</code></a> function. To take the plot from univariate to bivariate, we add the second variable to be plotted under the "hue" argument:</p>
<h3 id="example-1-plot-a-bar-chart-between-two-qualitative-variables">Example 1. Plot a Bar chart between two qualitative variables</h3>
<h4 id="preparatory-step-1---convert-the-vclass-column-from-a-plain-object-type-into-an-ordered-categorical-type">Preparatory Step 1 - Convert the "VClass" column from a plain object type into an ordered categorical type</h4>
<pre><code class="python language-python"># Types of sedan cars
sedan_classes = ['Minicompact Cars', 'Subcompact Cars', 'Compact Cars', 'Midsize Cars', 'Large Cars']

# Returns the types for sedan_classes with the categories and orderedness
# Refer - https://pandas.pydata.org/pandas-docs/version/0.23.4/generated/pandas.api.types.CategoricalDtype.html
vclasses = pd.api.types.CategoricalDtype(ordered=True, categories=sedan_classes)

# Use pandas.astype() to convert the "VClass" column from a plain object type into an ordered categorical type 
fuel_econ['VClass'] = fuel_econ['VClass'].astype(vclasses);</code></pre>
<h4 id="preparatory-step-2---add-a-new-column-for-transmission-type---automatic-or-manual">Preparatory Step 2 - Add a new column for transmission type - Automatic or Manual</h4>
<pre><code class="python language-python"># The existing `trans` column has multiple sub-types of Automatic and Manual. 
# But, we need plain two types, either Automatic or Manual. Therefore, add a new column. 

# The Series.apply() method invokes the `lambda` function on each value of `trans` column.
# In python, a `lambda` function is an anonymous function that can have only one expression.
fuel_econ['trans_type'] = fuel_econ['trans'].apply(lambda x:x.split()[0])
fuel_econ.head()</code></pre>
</div>

</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <figure class="figure">
    <img src="img/screenshot-2020-10-14-at-5.00.10-pm.png" alt="DataFrame after adding a new column &#x60;trans_type&#x60;" class="img img-fluid">
    <figcaption class="figure-caption">
      <p>DataFrame after adding a new column <code>trans_type</code></p>
    </figcaption>
  </figure>
</div>


</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <h4 id="step-3-plot-the-bar-chart">Step 3. Plot the bar chart</h4>
<pre><code class="python language-python">sb.countplot(data = fuel_econ, x = 'VClass', hue = 'trans_type')</code></pre>
</div>

</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <figure class="figure">
    <img src="img/download-57.png" alt="Bar chart between two qualitative variables, and one of them is ordered. " class="img img-fluid">
    <figcaption class="figure-caption">
      <p>Bar chart between two qualitative variables, and one of them is ordered. </p>
    </figcaption>
  </figure>
</div>


</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <h2 id="alternative-approach">Alternative Approach</h2>
<h3 id="example-2-plot-a-heat-map-between-two-qualitative-variables">Example 2. Plot a Heat Map between two qualitative variables</h3>
<p>One alternative way of depicting the relationship between two categorical variables is through a heat map. Heat maps were introduced earlier as the 2-D version of a histogram; here, we're using them as the 2-D version of a bar chart. The seaborn function <a href="https://seaborn.pydata.org/generated/seaborn.heatmap.html" rel="noopener noreferrer" target="_blank">heatmap()</a> is at home with this type of heat map implementation, but the input arguments are unlike most of the visualization functions that have been introduced in this course. Instead of providing the original dataframe, we need to summarize the counts into a matrix that will then be plotted.</p>
<h4 id="step-1---get-the-data-into-desirable-format---a-dataframe">Step 1 - Get the data into desirable format - a DataFrame</h4>
<pre><code class="python language-python"># Use group_by() and size() to get the number of cars and each combination of the two variable levels as a pandas Series
ct_counts = fuel_econ.groupby(['VClass', 'trans_type']).size()</code></pre>
</div>

</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <figure class="figure">
    <img src="img/screenshot-2020-10-14-at-5.06.22-pm.png" alt="Number of cars in each vehicle type and transmission combination" class="img img-fluid">
    <figcaption class="figure-caption">
      <p>Number of cars in each vehicle type and transmission combination</p>
    </figcaption>
  </figure>
</div>


</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <pre><code class="python language-python"># Use Series.reset_index() to convert a series into a dataframe object
ct_counts = ct_counts.reset_index(name='count')</code></pre>
</div>

</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <figure class="figure">
    <img src="img/screenshot-2020-10-14-at-5.08.14-pm.png" alt="A DataFrame object created from the Series generated in the step above" class="img img-fluid">
    <figcaption class="figure-caption">
      <p>A DataFrame object created from the Series generated in the step above</p>
    </figcaption>
  </figure>
</div>


</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <figure class="figure">
    <img src="img/screenshot-2020-10-14-at-5.09.35-pm.png" alt="The DataFrame to plot on heatmap" class="img img-fluid">
    <figcaption class="figure-caption">
      <p>The DataFrame to plot on heatmap</p>
    </figcaption>
  </figure>
</div>


</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <pre><code class="python language-python"># Use DataFrame.pivot() to rearrange the data, to have vehicle class on rows
ct_counts = ct_counts.pivot(index = 'VClass', columns = 'trans_type', values = 'count')</code></pre>
</div>

</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <p>Documentation: <a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.reset_index.html" rel="noopener noreferrer" target="_blank">Series <code>reset_index</code></a>, <a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.pivot.html" rel="noopener noreferrer" target="_blank">DataFrame <code>pivot</code></a></p>
</div>

</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <h4 id="step-2---plot-the-heatmap">Step 2 - Plot the heatmap</h4>
</div>

</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <pre><code class="python language-python">sb.heatmap(ct_counts)</code></pre>
</div>

</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <figure class="figure">
    <img src="img/download-58.png" alt="" class="img img-fluid">
    <figcaption class="figure-caption">
      
    </figcaption>
  </figure>
</div>


</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <p>The heat map tells the same story as the clustered bar chart. </p>
<h3 id="example-3-additional-variation">Example 3. Additional Variation</h3>
<pre><code class="python language-python">sb.heatmap(ct_counts, annot = True, fmt = 'd')</code></pre>
<p><code>annot = True</code> makes it so annotations show up in each cell, but the default string formatting only goes to two digits of precision. Adding <code>fmt = 'd'</code> means that annotations will all be formatted as integers instead. You can use <code>fmt = '.0f'</code> if you have any cells with no counts, in order to account for NaNs.</p>
</div>

</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <figure class="figure">
    <img src="img/download-59.png" alt="" class="img img-fluid">
    <figcaption class="figure-caption">
      
    </figcaption>
  </figure>
</div>


</div>
<div class="divider"></div>
          </div>

          <div class="col-12">
            <p class="text-right">
              <a href="10. Categorical Plot Practice.html" class="btn btn-outline-primary mt-4" role="button">Next Concept</a>
            </p>
          </div>
        </div>
      </main>

      <footer class="footer">
        <div class="container">
          <div class="row">
            <div class="col-12">
              <p class="text-center">
                <a href="https://us-udacity.github.io/" target="_blank">【udacity2.0 】If you need more courses, please add wechat：udacity6</a>
              </p>
            </div>
          </div>
        </div>
      </footer>
    </div>
  </div>


  <script src="../assets/js/jquery-3.3.1.min.js"></script>
  <script src="../assets/js/plyr.polyfilled.min.js"></script>
  <script src="../assets/js/bootstrap.min.js"></script>
  <script src="../assets/js/jquery.mCustomScrollbar.concat.min.js"></script>
  <script src="../assets/js/katex.min.js"></script>
  <script>
    // Initialize Plyr video players
    const players = Array.from(document.querySelectorAll('video')).map(p => new Plyr(p));

    // render math equations
    let elMath = document.getElementsByClassName('mathquill');
    for (let i = 0, len = elMath.length; i < len; i += 1) {
      const el = elMath[i];

      katex.render(el.textContent, el, {
        throwOnError: false
      });
    }

    // this hack will make sure Bootstrap tabs work when using Handlebars
    if ($('#question-tabs').length && $('#user-answer-tabs').length) {
      $("#question-tabs a.nav-link").on('click', function () {
        $("#question-tab-contents .tab-pane").hide();
        $($(this).attr("href")).show();
      });
      $("#user-answer-tabs a.nav-link").on('click', function () {
        $("#user-answer-tab-contents .tab-pane").hide();
        $($(this).attr("href")).show();
      });
    } else {
      $("a.nav-link").on('click', function () {
        $(".tab-pane").hide();
        $($(this).attr("href")).show();
      });
    }

    // side bar events
    $(document).ready(function () {
      $("#sidebar").mCustomScrollbar({
        theme: "minimal"
      });

      $('#sidebarCollapse').on('click', function () {
        $('#sidebar, #content').toggleClass('active');
        $('.collapse.in').toggleClass('in');
        $('a[aria-expanded=true]').attr('aria-expanded', 'false');
      });

      // scroll to first video on page loading
      if ($('video').length) {
        $('html,body').animate({ scrollTop: $('div.plyr').prev().offset().top});
      }

      // auto play first video: this may not work with chrome/safari due to autoplay policy
      if (players && players.length > 0) {
        players[0].play();
      }

      // scroll sidebar to current concept
      const currentInSideBar = $( "ul.sidebar-list.components li a:contains('09. Clustered Bar Charts')" )
      currentInSideBar.css( "text-decoration", "underline" );
      $("#sidebar").mCustomScrollbar('scrollTo', currentInSideBar);
    });
  </script>
</body>

</html>
